<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Trắc Nghiệm MBTI 60 Câu - Tư Vấn Cá Nhân</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: "Poppins", sans-serif;
      background: linear-gradient(135deg, #f0f8ff, #e6f7ff);
      color: #222;
      line-height: 1.7;
      overflow-x: hidden;
    }
    header {
      background: linear-gradient(90deg, #004aad, #0073e6);
      color: white;
      text-align: center;
      padding: 50px 20px;
      border-bottom-left-radius: 50px;
      border-bottom-right-radius: 50px;
      box-shadow: 0 5px 20px rgba(0,0,0,0.2);
    }
    h1 { font-size: 2.3rem; margin-bottom: 8px; }
    h1 + p { opacity: 0.9; font-size: 1.1rem; }

    #welcome {
      max-width: 900px;
      margin: 40px auto;
      background: white;
      border-radius: 20px;
      padding: 50px 30px;
      box-shadow: 0 8px 25px rgba(0,0,0,0.12);
      text-align: center;
      animation: fadeIn 1s ease-out;
    }
    #welcome h2 { font-size: 2.2rem; color: #004aad; margin-bottom: 20px; }
    #welcome p { font-size: 1.1rem; color: #444; margin-bottom: 30px; max-width: 700px; margin-left: auto; margin-right: auto; }
    .start-btn {
      background: linear-gradient(135deg, #004aad, #0066cc);
      color: white; padding: 16px 40px; border: none; border-radius: 12px;
      font-size: 1.2rem; font-weight: 600; cursor: pointer; transition: all 0.4s;
      box-shadow: 0 5px 15px rgba(0,74,173,0.3);
    }
    .start-btn:hover { transform: translateY(-4px); box-shadow: 0 10px 25px rgba(0,74,173,0.4); }

    main {
      max-width: 900px;
      margin: 30px auto;
      background: white;
      border-radius: 20px;
      padding: 35px;
      box-shadow: 0 8px 25px rgba(0,0,0,0.12);
      display: none;
    }
    .progress-container { height: 12px; background: #e0e0e0; border-radius: 10px; overflow: hidden; margin: 20px 0; }
    .progress-bar { width: 0%; height: 100%; background: linear-gradient(90deg, #004aad, #00aaff); transition: width 0.5s ease; }

    .question {
      margin-bottom: 28px; padding: 20px; background: #f9fbfd; border-radius: 14px;
      border-left: 5px solid #004aad; box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    }
    .question p { font-weight: 600; color: #004aad; margin-bottom: 14px; font-size: 1.05rem; }
    .options { display: grid; gap: 10px; }
    label {
      display: block; padding: 12px 16px; background: white; border: 2px solid #ddd;
      border-radius: 10px; cursor: pointer; transition: all 0.3s ease; font-size: 0.95rem;
    }
    label:hover { background: #e3f2fd; border-color: #004aad; transform: translateY(-2px); }
    input[type="radio"] { margin-right: 12px; transform: scale(1.2); }
    input[type="radio"]:checked + span { font-weight: 600; color: #004aad; }

    button {
      background: linear-gradient(135deg, #004aad, #0066cc);
      color: white; padding: 15px 35px; border: none; border-radius: 12px;
      font-size: 1.1rem; font-weight: 600; cursor: pointer; display: block;
      margin: 30px auto 0; transition: 0.4s; box-shadow: 0 5px 15px rgba(0,74,173,0.3);
    }
    button:hover { transform: translateY(-3px); box-shadow: 0 8px 20px rgba(0,74,173,0.4); }

    .result {
      background: linear-gradient(135deg, #e8f5e9, #f1f8e9); padding: 30px; border-radius: 16px;
      margin-top: 30px; border: 1px solid #c8e6c9; display: none;
    }
    .personality-type {
      font-size: 2.8rem; font-weight: 800; text-align: center; color: #004aad;
      margin: 10px 0; letter-spacing: 2px;
    }
    .dimensions { display: grid; grid-template-columns: repeat(auto-fit, minmax(130px, 1fr)); gap: 12px; margin: 20px 0; }
    .dim { background: white; padding: 14px; border-radius: 12px; text-align: center; font-weight: 600; color: #004aad; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
    .dim span { display: block; font-size: 0.85rem; color: #555; margin-top: 4px; font-weight: normal; }

    #suggestions { columns: 2; gap: 20px; margin-top: 15px; list-style: none; padding: 0; }
    #suggestions li { background: white; padding: 12px; margin-bottom: 10px; border-radius: 10px; break-inside: avoid; box-shadow: 0 2px 6px rgba(0,0,0,0.08); }

    .consult-btn {
      background: linear-gradient(135deg, #e65100, #fb8c00);
      color: white; padding: 14px 30px; border: none; border-radius: 12px;
      font-size: 1.1rem; font-weight: 600; cursor: pointer; margin: 20px auto 0;
      display: block; transition: 0.4s; box-shadow: 0 5px 15px rgba(230,81,0,0.3);
    }
    .consult-btn:hover { transform: translateY(-3px); box-shadow: 0 8px 20px rgba(230,81,0,0.4); }

    #consultation-page {
      display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,0.7); z-index: 9999; justify-content: center; align-items: center; padding: 20px;
    }
    .consultation-modal {
      background: white; border-radius: 20px; max-width: 800px; width: 100%; max-height: 90vh;
      overflow-y: auto; box-shadow: 0 20px 50px rgba(0,0,0,0.3); animation: modalIn 0.5s ease-out;
    }
    .modal-header {
      background: linear-gradient(135deg, #004aad, #0073e6); color: white; padding: 25px;
      border-radius: 20px 20px 0 0; text-align: center; position: relative;
    }
    .modal-header h2 { font-size: 2rem; margin-bottom: 8px; }
    .close-btn {
      position: absolute; top: 15px; right: 20px; background: rgba(255,255,255,0.2);
      color: white; border: none; width: 40px; height: 40px; border-radius: 50%;
      font-size: 1.5rem; cursor: pointer; transition: 0.3s;
    }
    .close-btn:hover { background: rgba(255,255,255,0.4); }
    .modal-body { padding: 30px; }
    .mbti-title { font-size: 2.5rem; text-align: center; color: #004aad; margin-bottom: 10px; font-weight: 800; }
    .mbti-subtitle { text-align: center; color: #e65100; font-weight: 600; margin-bottom: 25px; }

    .section {
      margin-bottom: 30px; background: #f8f9fa; padding: 20px; border-radius: 14px;
      border-left: 5px solid #004aad;
    }
    .section h3 { color: #004aad; margin-bottom: 15px; font-size: 1.3rem; display: flex; align-items: center; gap: 10px; }
    .section ul { margin-left: 20px; font-size: 1rem; }
    .section li { margin-bottom: 8px; }

    .majors { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 16px; margin-top: 20px; }
    .major-card { background: #f8f9fa; padding: 18px; border-radius: 12px; text-align: center; box-shadow: 0 3px 10px rgba(0,0,0,0.1); transition: 0.3s; }
    .major-card:hover { background: #dbeafe; transform: translateY(-6px); box-shadow: 0 10px 20px rgba(0,0,0,0.15); }

    #history { background: #fff7ed; padding: 25px; border-radius: 14px; margin-top: 30px; }
    #history-list { list-style: none; padding: 0; }
    #history-list li { padding: 10px 0; border-bottom: 1px dashed #ffb74d; font-size: 0.95rem; }

    footer { text-align: center; padding: 30px; background: #f0f0f0; color: #666; margin-top: 50px; font-size: 0.9rem; }

    @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes modalIn { from { opacity: 0; transform: scale(0.8); } to { opacity: 1; transform: scale(1); } }

    @media (max-width: 600px) {
      h1 { font-size: 1.9rem; } #welcome { padding: 30px 20px; margin: 15px; } #welcome h2 { font-size: 1.8rem; }
      main { padding: 20px; margin: 15px; } .question { padding: 16px; } .personality-type { font-size: 2.2rem; }
      .consultation-modal { padding: 15px; } .modal-body { padding: 20px; } .mbti-title { font-size: 2rem; }
    }
  </style>
</head>
<body>

<header>
  <h1>Trắc Nghiệm MBTI 60 Câu</h1>
  <p>4 đáp án chuẩn • Chính xác • Tư vấn cá nhân riêng</p>
</header>

<section id="welcome">
  <h2>Khám Phá Tính Cách & Tương Lai</h2>
  <p>60 câu hỏi khoa học + tư vấn cá nhân chi tiết riêng biệt.</p>
  <button class="start-btn" onclick="startQuiz()">Bắt đầu làm bài</button>
</section>

<main id="main-content">
  <div class="progress-container"><div class="progress-bar" id="progress"></div></div>

  <section id="quiz">
    <h2>Trắc Nghiệm Tính Cách (60 câu)</h2>
    <form id="quizForm">
      <div id="questions"></div>
      <button type="button" onclick="submitQuiz()">Xem Kết Quả</button>
    </form>
  </section>

  <section class="result" id="result">
    <h2>Kết Quả Của Bạn</h2>
    <div class="personality-type" id="personality"></div>
    <p>Nhóm MBTI: <strong id="mbtiType"></strong></p>

    <h3>Phân tích chi tiết:</h3>
    <div class="dimensions" id="dimensions"></div>

    <h3>Ngành nghề phù hợp:</h3>
    <ul id="suggestions"></ul>

    <button class="consult-btn" onclick="openConsultation()">Mở Tư Vấn Cá Nhân Chi Tiết</button>
  </section>

  <section id="majors-list">
    <h2>Danh Sách Ngành Học Theo MBTI</h2>
    <div class="majors" id="majors"></div>
  </section>

  <section id="history">
    <h2>Lịch Sử Kết Quả</h2>
    <ul id="history-list"></ul>
  </section>
</main>

<!-- TRANG TƯ VẤN CÁ NHÂN RIÊNG -->
<div id="consultation-page">
  <div class="consultation-modal">
    <div class="modal-header">
      <h2>Tư Vấn Cá Nhân</h2>
      <button class="close-btn" onclick="closeConsultation()">X</button>
    </div>
    <div class="modal-body">
      <div class="mbti-title" id="consult-personality"></div>
      <div class="mbti-subtitle" id="consult-subtitle"></div>

      <div class="section strengths">
        <h3>Điểm Mạnh</h3>
        <ul id="consult-strengths"></ul>
      </div>

      <div class="section weaknesses">
        <h3>Điểm Cần Cải Thiện</h3>
        <ul id="consult-weaknesses"></ul>
      </div>

      <div class="section career">
        <h3>Lời Khuyên Nghề Nghiệp & Phát Triển</h3>
        <ul id="consult-advice"></ul>
      </div>
    </div>
  </div>
</div>

<footer>
  © 2025 | Trắc Nghiệm MBTI Pro • Thiết kế bởi <strong>AI & Thầy</strong>
</footer>

<script>
  // ====== DỮ LIỆU NGÀNH NGHỀ ======
  const majorsData = {
    "INTJ": ["Khoa học máy tính", "Kỹ sư phần mềm", "Phân tích dữ liệu", "Kiến trúc sư"],
    "INTP": ["Nhà nghiên cứu", "Phát triển phần mềm", "Vật lý", "Triết học"],
    "ENTJ": ["CEO", "Quản lý dự án", "Luật sư", "Tư vấn chiến lược"],
    "ENTP": ["Khởi nghiệp", "Marketing", "Phát minh", "Thiết kế sản phẩm"],
    "INFJ": ["Tâm lý học", "Cố vấn", "Giáo dục", "Viết sáng tạo"],
    "INFP": ["Nghệ thuật", "Viết văn", "Thiết kế", "Tư vấn"],
    "ENFJ": ["Giáo dục", "PR", "Quản lý nhân sự", "Tư vấn"],
    "ENFP": ["Truyền thông", "Marketing", "Du lịch", "Nghệ thuật"],
    "ISTJ": ["Kế toán", "Kiểm toán", "Quản lý", "Ngân hàng"],
    "ISFJ": ["Y tá", "Giáo viên", "Hành chính", "Xã hội học"],
    "ESTJ": ["Quản lý", "Cảnh sát", "Quân đội", "Luật"],
    "ESFJ": ["Điều dưỡng", "Dịch vụ khách hàng", "Giáo dục", "Marketing"],
    "ISTP": ["Kỹ sư cơ khí", "Lập trình", "Thợ sửa chữa", "Cảnh sát"],
    "ISFP": ["Nhiếp ảnh", "Âm nhạc", "Thiết kế đồ họa", "Nội thất"],
    "ESTP": ["Bất động sản", "Thể thao", "Kinh doanh", "Quảng cáo"],
    "ESFP": ["Diễn viên", "Giải trí", "Marketing", "Truyền thông"]
  };

  // ====== TƯ VẤN CHI TIẾT 16 LOẠI MBTI ======
  const personalityData = {
    "INTJ": { name: "Kiến Trúc Sư", desc: "Chiến lược gia, độc lập, tầm nhìn xa", strengths: ["Tư duy chiến lược", "Lập kế hoạch xuất sắc", "Tập trung cao độ", "Độc lập"], weaknesses: ["Khó thể hiện cảm xúc", "Coi thường người khác", "Quá cầu toàn"], advice: ["Học giao tiếp mềm dẻo", "Làm việc nhóm để phát triển", "Đừng bỏ qua cảm xúc người khác"] },
    "INTP": { name: "Nhà Tư Tưởng", desc: "Sáng tạo, logic, tò mò tri thức", strengths: ["Sáng tạo", "Phân tích sâu", "Tò mò", "Tư duy logic"], weaknesses: ["Hay trì hoãn", "Thiếu thực tế", "Khó hoàn thành"], advice: ["Đặt deadline rõ", "Biến ý tưởng thành hành động", "Tìm người hỗ trợ thực thi"] },
    "ENTJ": { name: "Người Lãnh Đạo", desc: "Quyết đoán, tầm nhìn, hiệu quả", strengths: ["Lãnh đạo bẩm sinh", "Quyết đoán", "Tầm nhìn xa", "Hiệu quả"], weaknesses: ["Áp đặt", "Thiếu kiên nhẫn", "Coi nhẹ cảm xúc"], advice: ["Lắng nghe nhiều hơn", "Tôn trọng ý kiến khác", "Phát triển đồng cảm"] },
    "ENTP": { name: "Nhà Tranh Luận", desc: "Sáng tạo, nhanh nhẹn, thuyết phục", strengths: ["Sáng tạo", "Nhanh nhẹn", "Thuyết phục", "Thích thử thách"], weaknesses: ["Bỏ dở giữa chừng", "Thiếu kiên trì", "Hay tranh luận"], advice: ["Tập trung một dự án", "Hoàn thành trước khi bắt đầu mới", "Học lắng nghe"] },
    "INFJ": { name: "Người Bảo Vệ", desc: "Đồng cảm, lý tưởng, trực giác mạnh", strengths: ["Đồng cảm sâu", "Tầm nhìn nhân văn", "Trực giác", "Lý tưởng"], weaknesses: ["Quá nhạy cảm", "Cầu toàn", "Khó từ chối"], advice: ["Học nói 'không'", "Bảo vệ năng lượng", "Tin vào trực giác"] },
    "INFP": { name: "Người Hòa Giải", desc: "Sáng tạo, lý tưởng, trung thành", strengths: ["Sáng tạo", "Lý tưởng", "Đồng cảm", "Trung thành"], weaknesses: ["Hay mơ mộng", "Tránh xung đột", "Dễ tổn thương"], advice: ["Biến ước mơ thành kế hoạch", "Đối mặt xung đột", "Tự tin thể hiện"] },
    "ENFJ": { name: "Người Dẫn Dắt", desc: "Truyền cảm hứng, đồng cảm, tổ chức", strengths: ["Truyền cảm hứng", "Đồng cảm", "Tổ chức tốt", "Thuyết phục"], weaknesses: ["Quá lo cho người khác", "Bỏ qua bản thân", "Dễ bị lợi dụng"], advice: ["Ưu tiên bản thân", "Học từ chối", "Giữ cân bằng"] },
    "ENFP": { name: "Người Truyền Cảm Hứng", desc: "Nhiệt huyết, sáng tạo, dễ gần", strengths: ["Nhiệt huyết", "Sáng tạo", "Dễ gần", "Truyền cảm hứng"], weaknesses: ["Mất tập trung", "Hay chán", "Tránh trách nhiệm"], advice: ["Hoàn thành việc đang làm", "Lập kế hoạch dài hạn", "Tận dụng năng lượng"] },
    "ISTJ": { name: "Người Quản Lý", desc: "Trách nhiệm, chi tiết, kỷ luật", strengths: ["Trách nhiệm", "Chi tiết", "Kỷ luật", "Đáng tin"], weaknesses: ["Cứng nhắc", "Khó thích nghi", "Không linh hoạt"], advice: ["Thử thay đổi nhỏ", "Chấp nhận rủi ro", "Học sáng tạo"] },
    "ISFJ": { name: "Người Bảo Vệ", desc: "Tận tâm, chu đáo, thực tế", strengths: ["Tận tâm", "Chu đáo", "Trung thành", "Thực tế"], weaknesses: ["Khó từ chối", "Sợ thay đổi", "Quá hy sinh"], advice: ["Đặt giới hạn", "Thử điều mới", "Yêu thương bản thân"] },
    "ESTJ": { name: "Giám Đốc", desc: "Quyết đoán, tổ chức, hiệu quả", strengths: ["Quyết đoán", "Tổ chức", "Hiệu quả", "Lãnh đạo"], weaknesses: ["Thiếu linh hoạt", "Áp đặt", "Coi thường cảm xúc"], advice: ["Linh hoạt hơn", "Lắng nghe", "Phát triển đồng cảm"] },
    "ESFJ": { name: "Người Chăm Sóc", desc: "Ấm áp, hỗ trợ, dễ gần", strengths: ["Ấm áp", "Hỗ trợ", "Tổ chức tốt", "Dễ gần"], weaknesses: ["Quá lo lắng", "Dễ bị ảnh hưởng", "Sợ bị từ chối"], advice: ["Tin vào bản thân", "Học độc lập", "Giữ ranh giới"] },
    "ISTP": { name: "Thợ Thủ Công", desc: "Thực tế, khéo léo, bình tĩnh", strengths: ["Thực tế", "Khéo léo", "Bình tĩnh", "Giải quyết vấn đề"], weaknesses: ["Ít nói", "Tránh cam kết", "Hay chán"], advice: ["Chia sẻ cảm xúc", "Cam kết dài hạn", "Tìm mục tiêu rõ"] },
    "ISFP": { name: "Nghệ Sĩ", desc: "Sáng tạo, nhạy cảm, thẩm mỹ", strengths: ["Sáng tạo", "Nhạy cảm", "Thẩm mỹ", "Tận tâm"], weaknesses: ["Tránh xung đột", "Dễ tổn thương", "Thiếu kế hoạch"], advice: ["Thể hiện bản thân", "Lập kế hoạch", "Đối mặt vấn đề"] },
    "ESTP": { name: "Doanh Nhân", desc: "Nhanh nhẹn, thích nghi, hành động", strengths: ["Nhanh nhẹn", "Thích nghi", "Thuyết phục", "Hành động"], weaknesses: ["Thiếu kiên nhẫn", "Mạo hiểm", "Bỏ qua chi tiết"], advice: ["Lập kế hoạch", "Kiểm soát rủi ro", "Chú ý chi tiết"] },
    "ESFP": { name: "Người Biểu Diễn", desc: "Vui vẻ, dễ gần, truyền năng lượng", strengths: ["Vui vẻ", "Dễ gần", "Thích nghi", "Truyền năng lượng"], weaknesses: ["Thiếu tập trung", "Tránh trách nhiệm", "Sống hiện tại"], advice: ["Lập kế hoạch tương lai", "Hoàn thành công việc", "Tự giác hơn"] }
  };

  // ====== 60 CÂU HỎI CHUẨN - ĐÃ DÁN ĐẦY ĐỦ ======
  const questionsData = [
    // EI - 15 câu
    {q:"Bạn cảm thấy tràn đầy năng lượng khi:", a:["Ở giữa đám đông, nói chuyện không ngừng","Thích đám đông hơn ở một mình","Tùy lúc, lúc thích đám đông","Chủ yếu thích ở một mình, suy nghĩ"], type:"EI"},
    {q:"Bạn dễ bắt chuyện với người lạ:", a:["Rất dễ, luôn chủ động","Thường dễ bắt chuyện","Tùy người","Hiếm khi bắt chuyện"], type:"EI"},
    {q:"Cuối tuần bạn thường:", a:["Đi chơi với bạn bè","Gặp gỡ bạn bè","Tùy hứng","Ở nhà đọc sách/suy nghĩ"], type:"EI"},
    {q:"Bạn thích làm việc:", a:["Nhóm đông người","Nhóm nhỏ","Tùy việc","Một mình hiệu quả hơn"], type:"EI"},
    {q:"Bạn nói chuyện trong nhóm:", a:["Luôn dẫn dắt cuộc trò chuyện","Nói nhiều","Nói vừa phải","Nghe nhiều hơn nói"], type:"EI"},
    {q:"Bạn thích:", a:["Tiệc tùng ồn ào","Gặp nhiều người","Tùy dịp","Không gian yên tĩnh"], type:"EI"},
    {q:"Bạn cảm thấy thoải mái hơn khi:", a:["Nói ra suy nghĩ ngay","Chia sẻ thường xuyên","Tùy lúc","Giữ suy nghĩ cho mình"], type:"EI"},
    {q:"Bạn có xu hướng:", a:["Kết bạn nhanh","Dễ gần","Tùy người","Chọn bạn kỹ"], type:"EI"},
    {q:"Bạn thích môi trường làm việc:", a:["Sôi động, nhiều người","Có đồng nghiệp vui vẻ","Bình thường","Yên tĩnh, tập trung"], type:"EI"},
    {q:"Bạn thường:", a:["Nói trước nghĩ sau","Nói nhiều hơn nghe","Cân bằng","Nghe trước, nói sau"], type:"EI"},
    {q:"Bạn thấy mình:", a:["Hướng ngoại, năng động","Thích giao tiếp","Tùy lúc","Hướng nội, sâu sắc"], type:"EI"},
    {q:"Bạn thích:", a:["Gặp gỡ người mới","Mở rộng mối quan hệ","Tùy người","Giữ mối quan hệ cũ"], type:"EI"},
    {q:"Bạn cảm thấy mệt mỏi khi:", a:["Ở một mình quá lâu","Ít giao tiếp","Tùy lúc","Ở đám đông quá lâu"], type:"EI"},
    {q:"Bạn thường:", a:["Chủ động mời bạn bè","Tổ chức tụ họp","Tùy hứng","Chờ người khác mời"], type:"EI"},
    {q:"Bạn thích công việc:", a:["Giao tiếp nhiều","Làm việc với khách hàng","Tùy việc","Làm việc độc lập"], type:"EI"},

    // SN - 15 câu
    {q:"Bạn chú ý đến:", a:["Chi tiết cụ thể, thực tế","Hầu hết là chi tiết","Cả chi tiết và ý tưởng","Ý tưởng lớn, tương lai"], type:"SN"},
    {q:"Bạn học tốt hơn qua:", a:["Thực hành trực tiếp","Làm là nhớ","Cả lý thuyết và thực hành","Lý thuyết, suy ngẫm"], type:"SN"},
    {q:"Bạn thích công việc:", a:["Cụ thể, rõ ràng","Có hướng dẫn chi tiết","Tùy việc","Sáng tạo, trừu tượng"], type:"SN"},
    {q:"Bạn quan sát thế giới qua:", a:["Những gì đang xảy ra","Thực tế trước mắt","Cân bằng","Ý nghĩa ẩn sau"], type:"SN"},
    {q:"Bạn nhớ tốt hơn:", a:["Sự kiện cụ thể","Chi tiết nhỏ","Tùy thứ","Ý tưởng tổng quát"], type:"SN"},
    {q:"Bạn thích đọc:", a:["Sách hướng dẫn, thực tế","Tài liệu cụ thể","Tùy thể loại","Tiểu thuyết, triết lý"], type:"SN"},
    {q:"Bạn giải quyết vấn đề bằng:", a:["Kinh nghiệm thực tế","Phương pháp đã biết","Tùy vấn đề","Tư duy sáng tạo"], type:"SN"},
    {q:"Bạn thấy mình:", a:["Thực tế, cụ thể","Chú ý chi tiết","Cân bằng","Trừu tượng, lý tưởng"], type:"SN"},
    {q:"Bạn thích môi trường:", a:["Ổn định, quen thuộc","Có quy trình rõ","Tùy nơi","Mới mẻ, thay đổi"], type:"SN"},
    {q:"Bạn đánh giá ý tưởng mới:", a:["Dựa trên thực tế","Khả thi không","Tùy ý tưởng","Tiềm năng tương lai"], type:"SN"},
    {q:"Bạn thích làm việc với:", a:["Dữ liệu cụ thể","Số liệu rõ ràng","Tùy công việc","Khái niệm trừu tượng"], type:"SN"},
    {q:"Bạn thường nghĩ về:", a:["Hiện tại, thực tế","Việc đang làm","Cân bằng","Tương lai, khả năng"], type:"SN"},
    {q:"Bạn học môn mới bằng:", a:["Làm thử ngay","Thực hành nhiều","Tùy môn","Đọc lý thuyết trước"], type:"SN"},
    {q:"Bạn thích công việc:", a:["Lặp lại, quen thuộc","Có quy trình","Tùy việc","Đổi mới liên tục"], type:"SN"},
    {q:"Bạn thấy mình quan tâm đến:", a:["Chi tiết nhỏ","Thực tế hàng ngày","Cân bằng","Ý nghĩa sâu xa"], type:"SN"},

    // TF - 15 câu
    {q:"Khi quyết định, bạn:", a:["Chỉ dựa vào logic","Chủ yếu lý trí","Cân bằng","Chủ yếu cảm xúc"], type:"TF"},
    {q:"Bạn dễ bị ảnh hưởng bởi:", a:["Sự bất công","Nguyên tắc sai","Tùy tình huống","Nỗi buồn của người khác"], type:"TF"},
    {q:"Bạn đánh giá người khác qua:", a:["Hiệu quả công việc","Khả năng","Tùy người","Sự tử tế, ấm áp"], type:"TF"},
    {q:"Bạn khó chịu khi:", a:["Ai đó không logic","Quy tắc bị phá","Tùy việc","Ai đó bị tổn thương"], type:"TF"},
    {q:"Bạn ưu tiên:", a:["Sự thật, dù phũ","Công bằng","Tùy lúc","Giữ hòa khí"], type:"TF"},
    {q:"Bạn thấy mình:", a:["Lý trí, khách quan","Phân tích tốt","Cân bằng","Cảm xúc, đồng cảm"], type:"TF"},
    {q:"Bạn phản ứng với xung đột:", a:["Giải quyết ngay","Tìm nguyên nhân","Tùy mức độ","Tránh làm tổn thương"], type:"TF"},
    {q:"Bạn khen ngợi người khác vì:", a:["Thành tích xuất sắc","Kết quả tốt","Tùy người","Nỗ lực, tâm huyết"], type:"TF"},
    {q:"Bạn dễ tha thứ khi:", a:["Họ thừa nhận sai","Có lý do hợp lý","Tùy lỗi","Họ xin lỗi chân thành"], type:"TF"},
    {q:"Bạn thấy khó khăn khi:", a:["Phải nói dối","Che giấu sự thật","Tùy lúc","Làm ai đó buồn"], type:"TF"},
    {q:"Bạn đánh giá thành công bằng:", a:["Kết quả đo lường được","Chỉ số rõ ràng","Cân bằng","Mọi người hài lòng"], type:"TF"},
    {q:"Bạn thường:", a:["Phê bình xây dựng","Chỉ ra lỗi","Tùy lúc","Động viên, khích lệ"], type:"TF"},
    {q:"Bạn thấy mình quan tâm đến:", a:["Hiệu quả, năng suất","Mục tiêu đạt được","Cân bằng","Cảm xúc của mọi người"], type:"TF"},
    {q:"Bạn dễ khóc khi:", a:["Hiếm khi, trừ phi rất buồn","Chỉ khi xúc động mạnh","Tùy tình huống","Dễ khóc, đồng cảm"], type:"TF"},
    {q:"Bạn đưa ra quyết định dựa trên:", a:["Dữ liệu, phân tích","Lý trí là chính","Cân bằng","Trực giác, cảm xúc"], type:"TF"},

    // JP - 15 câu
    {q:"Bạn thích công việc:", a:["Có kế hoạch rõ ràng","Quy trình từng bước","Linh hoạt vừa phải","Tự do, không gò bó"], type:"JP"},
    {q:"Bạn lập danh sách việc cần làm:", a:["Luôn luôn, chi tiết","Thường xuyên","Tùy ngày","Hiếm khi, tùy hứng"], type:"JP"},
    {q:"Bạn cảm thấy khó chịu khi:", a:["Mọi thứ lộn xộn","Không có kế hoạch","Tùy mức độ","Mọi thứ quá cứng nhắc"], type:"JP"},
    {q:"Bạn sắp xếp bàn làm việc:", a:["Rất ngăn nắp","Gọn gàng","Bình thường","Lộn xộn có sáng tạo"], type:"JP"},
    {q:"Bạn thích deadline:", a:["Rõ ràng, cụ thể","Có thời hạn","Tùy việc","Linh hoạt, tự do"], type:"JP"},
    {q:"Bạn thấy mình:", a:["Có tổ chức, kỷ luật","Thích cấu trúc","Cân bằng","Linh hoạt, thích ứng"], type:"JP"},
    {q:"Bạn lên kế hoạch cho kỳ nghỉ:", a:["Chi tiết từng ngày","Có lịch trình","Tùy hứng một phần","Tùy theo cảm hứng"], type:"JP"},
    {q:"Bạn ghét nhất:", a:["Sự bất ngờ","Thay đổi đột ngột","Tùy mức độ","Quá nhiều quy tắc"], type:"JP"},
    {q:"Bạn làm việc tốt hơn khi:", a:["Có danh sách công việc","Mọi thứ rõ ràng","Tùy công việc","Tự do sáng tạo"], type:"JP"},
    {q:"Bạn thường hoàn thành công việc:", a:["Trước deadline","Đúng hạn","Gần deadline","Khi có cảm hứng"], type:"JP"},
    {q:"Bạn thích môi trường:", a:["Ổn định, có quy củ","Có cấu trúc","Tùy nơi","Thay đổi, linh hoạt"], type:"JP"},
    {q:"Bạn thấy mình:", a:["Kỷ luật, trách nhiệm","Thích trật tự","Cân bằng","Tự do, thoải mái"], type:"JP"},
    {q:"Bạn chuẩn bị cho buổi họp:", a:["Chuẩn bị kỹ tài liệu","Có kế hoạch rõ","Tùy buổi","Đến là nói"], type:"JP"},
    {q:"Bạn thích công việc:", a:["Có mục tiêu rõ ràng","Kết quả đo lường","Tùy việc","Mở, nhiều khả năng"], type:"JP"},
    {q:"Bạn cảm thấy thoải mái hơn khi:", a:["Mọi thứ được lên lịch","Có kế hoạch","Một phần kế hoạch","Không cần kế hoạch"], type:"JP"}
  ];

  let finalPersonality = "";

  // ====== BẮT ĐẦU, TIẾN ĐỘ, TÍNH ĐIỂM ======
  function startQuiz() {
    document.getElementById("welcome").style.display = "none";
    const main = document.getElementById("main-content");
    main.style.display = "block";
    main.scrollIntoView({ behavior: "smooth" });

    if (document.getElementById("questions").children.length === 0) {
      const questionsDiv = document.getElementById("questions");
      questionsData.forEach((item, i) => {
        const qDiv = document.createElement("div"); qDiv.className = "question";
        let html = `<p>${i+1}. ${item.q}</p><div class="options">`;
        item.a.forEach((opt, j) => {
          html += `<label><input type="radio" name="q${i}" value="${j}" onchange="updateProgress()"> <span>${opt}</span></label>`;
        });
        html += `</div>`;
        qDiv.innerHTML = html;
        questionsDiv.appendChild(qDiv);
      });
    }
  }

  function updateProgress() {
    const total = questionsData.length;
    const answered = document.querySelectorAll('input[type="radio"]:checked').length;
    const percent = (answered / total) * 100;
    document.getElementById("progress").style.width = percent + "%";
  }

  function submitQuiz() {
    const answers = [];
    for (let i = 0; i < questionsData.length; i++) {
      const selected = document.querySelector(`input[name="q${i}"]:checked`);
      if (!selected) { alert("Vui lòng trả lời hết 60 câu!"); return; }
      answers.push(parseInt(selected.value));
    }

    let scores = {E:0, I:0, S:0, N:0, T:0, F:0, J:0, P:0};
    questionsData.forEach((q, i) => {
      const val = answers[i];
      const pointMap = [3, 1, -1, -3];
      const point = pointMap[val];
      if (q.type === "EI") scores[val <= 1 ? "E" : "I"] += Math.abs(point);
      if (q.type === "SN") scores[val <= 1 ? "S" : "N"] += Math.abs(point);
      if (q.type === "TF") scores[val <= 1 ? "T" : "F"] += Math.abs(point);
      if (q.type === "JP") scores[val <= 1 ? "J" : "P"] += Math.abs(point);
    });

    finalPersonality = 
      (scores.E > scores.I ? "E" : "I") +
      (scores.N > scores.S ? "N" : "S") +
      (scores.T > scores.F ? "T" : "F") +
      (scores.J > scores.P ? "J" : "P");

    document.getElementById("personality").innerText = finalPersonality;
    document.getElementById("mbtiType").innerText = finalPersonality;

    const total = (a, b) => scores[a] + scores[b];
    document.getElementById("dimensions").innerHTML = `
      <div class="dim">I ${Math.round(scores.I/total('E','I')*100)}% <span>vs E ${Math.round(scores.E/total('E','I')*100)}%</span></div>
      <div class="dim">S ${Math.round(scores.S/total('S','N')*100)}% <span>vs N ${Math.round(scores.N/total('S','N')*100)}%</span></div>
      <div class="dim">T ${Math.round(scores.T/total('T','F')*100)}% <span>vs F ${Math.round(scores.F/total('T','F')*100)}%</span></div>
      <div class="dim">J ${Math.round(scores.J/total('J','P')*100)}% <span>vs P ${Math.round(scores.P/total('J','P')*100)}%</span></div>
    `;

    const suggestion = majorsData[finalPersonality] || ["Chưa xác định"];
    document.getElementById("suggestions").innerHTML = suggestion.map(m => `<li><strong>${m}</strong></li>`).join('');

    document.getElementById("result").style.display = "block";
    document.getElementById("result").scrollIntoView({ behavior: "smooth" });

    const history = JSON.parse(localStorage.getItem("mbti_history") || "[]");
    history.push({ time: new Date().toLocaleString('vi-VN'), personality: finalPersonality });
    if (history.length > 10) history.shift();
    localStorage.setItem("mbti_history", JSON.stringify(history));
    updateHistory();
  }

  // ====== TƯ VẤN CÁ NHÂN ======
  function openConsultation() {
    const data = personalityData[finalPersonality];
    document.getElementById("consult-personality").innerText = finalPersonality;
    document.getElementById("consult-subtitle").innerText = `${data.name} — ${data.desc}`;
    document.getElementById("consult-strengths").innerHTML = data.strengths.map(s => `<li>${s}</li>`).join('');
    document.getElementById("consult-weaknesses").innerHTML = data.weaknesses.map(w => `<li>${w}</li>`).join('');
    document.getElementById("consult-advice").innerHTML = data.advice.map(a => `<li>${a}</li>`).join('');
    document.getElementById("consultation-page").style.display = "flex";
  }

  function closeConsultation() {
    document.getElementById("consultation-page").style.display = "none";
  }

  function updateHistory() {
    const list = document.getElementById("history-list");
    const history = JSON.parse(localStorage.getItem("mbti_history") || "[]");
    list.innerHTML = history.length ? 
      history.reverse().map(h => `<li><strong>${h.personality}</strong> — ${h.time}</li>`).join('') :
      "<li>Chưa có kết quả</li>";
  }
  updateHistory();

  // Danh sách ngành
  const majorsDiv = document.getElementById("majors");
  for (const type in majorsData) {
    majorsData[type].forEach(m => {
      const card = document.createElement("div");
      card.className = "major-card";
      card.innerHTML = `<strong>${m}</strong><br><em>Phù hợp: ${type}</em>`;
      majorsDiv.appendChild(card);
    });
  }
</script>

</body>
</html>